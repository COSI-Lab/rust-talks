version: "3.9"

services:
  web:
    depends_on: 
      - db
    ports:
      - 8001:8001
    environment:
      VIRTUAL_PORT: 8001
      VIRTUAL_HOST: talks.cosi.clarkson.edu,talks.cslabs.clarkson.edu
      LETSENCRYPT_HOST: talks.cosi.clarkson.edu,talks.cslabs.clarkson.edu
    volumes:
      - ./talks.db:/rust-talks/talks.db
    build:
      context: .
      args: 
        VIRTUAL_PORT: 8001

volumes:
  database-data:

networks:
  default:
    external:
      name: nginx-proxy
